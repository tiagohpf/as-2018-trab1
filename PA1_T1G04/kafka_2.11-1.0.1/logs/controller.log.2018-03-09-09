[2018-03-09 10:01:08,230] INFO [Controller id=0] Shutting down broker 1 (kafka.controller.KafkaController)
[2018-03-09 10:01:08,230] DEBUG [Controller id=0] All shutting down brokers: 1 (kafka.controller.KafkaController)
[2018-03-09 10:01:08,230] DEBUG [Controller id=0] Live brokers: 0 (kafka.controller.KafkaController)
[2018-03-09 10:01:08,233] INFO [PartitionStateMachine controllerId=0] Invoking state change to OnlinePartition for partitions EnrichTopic-0 (kafka.controller.PartitionStateMachine)
[2018-03-09 10:01:08,242] DEBUG [ControlledShutdownLeaderSelector]: Partition EnrichTopic-0 : current leader = 1, new leader = 0 (kafka.controller.ControlledShutdownLeaderSelector)
[2018-03-09 10:01:08,251] DEBUG [PartitionStateMachine controllerId=0] After leader election, leader cache for EnrichTopic-0 is updated to (Leader:0,ISR:0,LeaderEpoch:1,ControllerEpoch:2) (kafka.controller.PartitionStateMachine)
[2018-03-09 10:01:08,266] TRACE [Controller id=0] All leaders = EnrichTopic-0 -> (Leader:0,ISR:0,LeaderEpoch:1,ControllerEpoch:2) (kafka.controller.KafkaController)
[2018-03-09 10:01:09,268] INFO [Controller id=0] Newly added brokers: , deleted brokers: 1, all live brokers: 0 (kafka.controller.KafkaController)
[2018-03-09 10:01:09,268] INFO [Controller-0-to-broker-1-send-thread]: Shutting down (kafka.controller.RequestSendThread)
[2018-03-09 10:01:09,268] INFO [Controller-0-to-broker-1-send-thread]: Stopped (kafka.controller.RequestSendThread)
[2018-03-09 10:01:09,268] INFO [Controller-0-to-broker-1-send-thread]: Shutdown completed (kafka.controller.RequestSendThread)
[2018-03-09 10:01:09,271] INFO [Controller id=0] Broker failure callback for 1 (kafka.controller.KafkaController)
[2018-03-09 10:01:09,272] INFO [Controller id=0] Removed ArrayBuffer(1) from list of shutting down brokers. (kafka.controller.KafkaController)
[2018-03-09 10:01:09,277] INFO [PartitionStateMachine controllerId=0] Invoking state change to OfflinePartition for partitions  (kafka.controller.PartitionStateMachine)
[2018-03-09 10:01:09,277] INFO [ReplicaStateMachine controllerId=0] Invoking state change to OfflineReplica for replicas [Topic=EnrichTopic,Partition=0,Replica=1] (kafka.controller.ReplicaStateMachine)
[2018-03-09 10:01:09,279] DEBUG [Controller id=0] Removing replica 1 from ISR 0 for partition EnrichTopic-0. (kafka.controller.KafkaController)
[2018-03-09 10:01:09,286] WARN [Controller id=0] Cannot remove replica 1 from ISR of partition EnrichTopic-0 since it is not in the ISR. Leader = 0 ; ISR = List(0) (kafka.controller.KafkaController)
[2018-03-09 10:01:09,288] DEBUG The stop replica request (delete = true) sent to broker 1 is  (kafka.controller.ControllerBrokerRequestBatch)
[2018-03-09 10:01:09,289] DEBUG The stop replica request (delete = false) sent to broker 1 is [Topic=EnrichTopic,Partition=0,Replica=1] (kafka.controller.ControllerBrokerRequestBatch)
[2018-03-09 10:01:09,294] WARN [Channel manager on controller 0]: Not sending request (type=StopReplicaRequest, controllerId=0, controllerEpoch=2, deletePartitions=false, partitions=EnrichTopic-0) to broker 1, since it is offline. (kafka.controller.ControllerChannelManager)
[2018-03-09 10:01:12,794] INFO [Controller id=0] Shutting down broker 0 (kafka.controller.KafkaController)
[2018-03-09 10:01:12,794] DEBUG [Controller id=0] All shutting down brokers: 0 (kafka.controller.KafkaController)
[2018-03-09 10:01:12,794] DEBUG [Controller id=0] Live brokers:  (kafka.controller.KafkaController)
[2018-03-09 10:01:12,795] INFO [PartitionStateMachine controllerId=0] Invoking state change to OnlinePartition for partitions EnrichTopic-0 (kafka.controller.PartitionStateMachine)
[2018-03-09 10:01:12,799] TRACE [Controller id=0] All leaders = EnrichTopic-0 -> (Leader:0,ISR:0,LeaderEpoch:1,ControllerEpoch:2) (kafka.controller.KafkaController)
[2018-03-09 10:01:14,306] TRACE [Controller id=0] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2018-03-09 10:01:14,306] DEBUG [Controller id=0] Preferred replicas by broker Map(1 -> Map(EnrichTopic-0 -> Vector(1, 0))) (kafka.controller.KafkaController)
[2018-03-09 10:01:14,307] DEBUG [Controller id=0] Topics not in preferred replica Map(EnrichTopic-0 -> Vector(1, 0)) (kafka.controller.KafkaController)
[2018-03-09 10:01:14,307] TRACE [Controller id=0] Leader imbalance ratio for broker 1 is 1.0 (kafka.controller.KafkaController)
[2018-03-09 10:01:17,803] INFO [Controller id=0] Shutting down broker 0 (kafka.controller.KafkaController)
[2018-03-09 10:01:17,803] DEBUG [Controller id=0] All shutting down brokers: 0 (kafka.controller.KafkaController)
[2018-03-09 10:01:17,803] DEBUG [Controller id=0] Live brokers:  (kafka.controller.KafkaController)
[2018-03-09 10:01:17,803] INFO [PartitionStateMachine controllerId=0] Invoking state change to OnlinePartition for partitions EnrichTopic-0 (kafka.controller.PartitionStateMachine)
[2018-03-09 10:01:17,804] TRACE [Controller id=0] All leaders = EnrichTopic-0 -> (Leader:0,ISR:0,LeaderEpoch:1,ControllerEpoch:2) (kafka.controller.KafkaController)
[2018-03-09 10:01:53,282] INFO [Controller id=0] Shutting down broker 0 (kafka.controller.KafkaController)
[2018-03-09 10:01:53,282] DEBUG [Controller id=0] All shutting down brokers: 0 (kafka.controller.KafkaController)
[2018-03-09 10:01:53,282] DEBUG [Controller id=0] Live brokers:  (kafka.controller.KafkaController)
[2018-03-09 10:01:53,282] INFO [PartitionStateMachine controllerId=0] Invoking state change to OnlinePartition for partitions EnrichTopic-0 (kafka.controller.PartitionStateMachine)
[2018-03-09 10:01:53,283] TRACE [Controller id=0] All leaders = EnrichTopic-0 -> (Leader:0,ISR:0,LeaderEpoch:1,ControllerEpoch:2) (kafka.controller.KafkaController)
[2018-03-09 10:01:59,274] INFO [controller-event-thread]: Shutting down (kafka.controller.ControllerEventManager$ControllerEventThread)
[2018-03-09 10:01:59,274] INFO [controller-event-thread]: Stopped (kafka.controller.ControllerEventManager$ControllerEventThread)
[2018-03-09 10:01:59,275] INFO [controller-event-thread]: Shutdown completed (kafka.controller.ControllerEventManager$ControllerEventThread)
[2018-03-09 10:01:59,275] DEBUG [Controller id=0] Resigning (kafka.controller.KafkaController)
[2018-03-09 10:01:59,275] DEBUG [Controller id=0] De-registering IsrChangeNotificationListener (kafka.controller.KafkaController)
[2018-03-09 10:01:59,275] DEBUG [Controller id=0] De-registering logDirEventNotificationListener (kafka.controller.KafkaController)
[2018-03-09 10:01:59,277] INFO [PartitionStateMachine controllerId=0] Stopped partition state machine (kafka.controller.PartitionStateMachine)
[2018-03-09 10:01:59,277] INFO [ReplicaStateMachine controllerId=0] Stopped replica state machine (kafka.controller.ReplicaStateMachine)
[2018-03-09 10:01:59,278] INFO [Controller-0-to-broker-0-send-thread]: Shutting down (kafka.controller.RequestSendThread)
[2018-03-09 10:01:59,278] INFO [Controller-0-to-broker-0-send-thread]: Stopped (kafka.controller.RequestSendThread)
[2018-03-09 10:01:59,278] INFO [Controller-0-to-broker-0-send-thread]: Shutdown completed (kafka.controller.RequestSendThread)
[2018-03-09 10:01:59,283] INFO [Controller id=0] Resigned (kafka.controller.KafkaController)
