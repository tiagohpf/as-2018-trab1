[2018-03-09 10:01:08,234] TRACE [Controller id=0 epoch=2] Started leader election for partition EnrichTopic-0 (state.change.logger)
[2018-03-09 10:01:08,250] TRACE [Controller id=0 epoch=2] Elected leader 0 for Offline partition EnrichTopic-0 (state.change.logger)
[2018-03-09 10:01:08,251] TRACE [Controller id=0 epoch=2] Changed partition EnrichTopic-0 from OnlinePartition to OnlinePartition with leader 0 (state.change.logger)
[2018-03-09 10:01:08,251] TRACE [Controller id=0 epoch=2] Sending become-follower LeaderAndIsr request PartitionState(controllerEpoch=2, leader=0, leaderEpoch=1, isr=0, zkVersion=1, replicas=1,0, isNew=false) to broker 1 for partition EnrichTopic-0 (state.change.logger)
[2018-03-09 10:01:08,251] TRACE [Controller id=0 epoch=2] Sending become-leader LeaderAndIsr request PartitionState(controllerEpoch=2, leader=0, leaderEpoch=1, isr=0, zkVersion=1, replicas=1,0, isNew=false) to broker 0 for partition EnrichTopic-0 (state.change.logger)
[2018-03-09 10:01:08,255] TRACE [Controller id=0 epoch=2] Sending UpdateMetadata request PartitionState(controllerEpoch=2, leader=0, leaderEpoch=1, isr=[0], zkVersion=1, replicas=[1, 0], offlineReplicas=[1]) to brokers Set(0, 1) for partition EnrichTopic-0 (state.change.logger)
[2018-03-09 10:01:08,255] TRACE [Broker id=0] Received LeaderAndIsr request PartitionState(controllerEpoch=2, leader=0, leaderEpoch=1, isr=0, zkVersion=1, replicas=1,0, isNew=false) correlation id 4 from controller 0 epoch 2 for partition EnrichTopic-0 (state.change.logger)
[2018-03-09 10:01:08,265] TRACE [Broker id=0] Handling LeaderAndIsr request correlationId 4 from controller 0 epoch 2 starting the become-leader transition for partition EnrichTopic-0 (state.change.logger)
[2018-03-09 10:01:08,284] TRACE [Controller id=0 epoch=2] Received response {error_code=0,partitions=[{topic=EnrichTopic,partition=0,error_code=0}]} for a request sent to broker kde:9093 (id: 1 rack: null) (state.change.logger)
[2018-03-09 10:01:08,287] TRACE [Controller id=0 epoch=2] Received response {error_code=0} for a request sent to broker kde:9093 (id: 1 rack: null) (state.change.logger)
[2018-03-09 10:01:08,331] TRACE [Broker id=0] Stopped fetchers as part of become-leader request from controller 0 epoch 2 with correlation id 4 for partition EnrichTopic-0 (last update controller epoch 2) (state.change.logger)
[2018-03-09 10:01:08,332] TRACE [Broker id=0] Completed LeaderAndIsr request correlationId 4 from controller 0 epoch 2 for the become-leader transition for partition EnrichTopic-0 (state.change.logger)
[2018-03-09 10:01:08,339] TRACE [Controller id=0 epoch=2] Received response {error_code=0,partitions=[{topic=EnrichTopic,partition=0,error_code=0}]} for a request sent to broker kde:9092 (id: 0 rack: null) (state.change.logger)
[2018-03-09 10:01:08,340] TRACE [Broker id=0] Cached leader info PartitionState(controllerEpoch=2, leader=0, leaderEpoch=1, isr=[0], zkVersion=1, replicas=[1, 0], offlineReplicas=[1]) for partition EnrichTopic-0 in response to UpdateMetadata request sent by controller 0 epoch 2 with correlation id 5 (state.change.logger)
[2018-03-09 10:01:08,340] TRACE [Controller id=0 epoch=2] Received response {error_code=0} for a request sent to broker kde:9092 (id: 0 rack: null) (state.change.logger)
[2018-03-09 10:01:09,286] TRACE [Controller id=0 epoch=2] Changed state of replica 1 for partition EnrichTopic-0 from OnlineReplica to OfflineReplica (state.change.logger)
[2018-03-09 10:01:09,287] TRACE [Controller id=0 epoch=2] Sending become-leader LeaderAndIsr request PartitionState(controllerEpoch=2, leader=0, leaderEpoch=1, isr=0, zkVersion=1, replicas=1,0, isNew=false) to broker 0 for partition EnrichTopic-0 (state.change.logger)
[2018-03-09 10:01:09,287] TRACE [Controller id=0 epoch=2] Sending UpdateMetadata request PartitionState(controllerEpoch=2, leader=0, leaderEpoch=1, isr=[0], zkVersion=1, replicas=[1, 0], offlineReplicas=[1]) to brokers Set(0) for partition EnrichTopic-0 (state.change.logger)
[2018-03-09 10:01:09,288] TRACE [Broker id=0] Received LeaderAndIsr request PartitionState(controllerEpoch=2, leader=0, leaderEpoch=1, isr=0, zkVersion=1, replicas=1,0, isNew=false) correlation id 6 from controller 0 epoch 2 for partition EnrichTopic-0 (state.change.logger)
[2018-03-09 10:01:09,289] WARN [Broker id=0] Ignoring LeaderAndIsr request from controller 0 with correlation id 6 epoch 2 for partition EnrichTopic-0 since its associated leader epoch 1 is not higher than the current leader epoch 1 (state.change.logger)
[2018-03-09 10:01:09,289] TRACE [Controller id=0 epoch=2] Received response {error_code=0,partitions=[{topic=EnrichTopic,partition=0,error_code=11}]} for a request sent to broker kde:9092 (id: 0 rack: null) (state.change.logger)
[2018-03-09 10:01:09,294] TRACE [Controller id=0 epoch=2] Sending UpdateMetadata request PartitionState(controllerEpoch=2, leader=0, leaderEpoch=1, isr=[0], zkVersion=1, replicas=[1, 0], offlineReplicas=[1]) to brokers Set(0) for partition EnrichTopic-0 (state.change.logger)
[2018-03-09 10:01:09,295] TRACE [Broker id=0] Cached leader info PartitionState(controllerEpoch=2, leader=0, leaderEpoch=1, isr=[0], zkVersion=1, replicas=[1, 0], offlineReplicas=[1]) for partition EnrichTopic-0 in response to UpdateMetadata request sent by controller 0 epoch 2 with correlation id 7 (state.change.logger)
[2018-03-09 10:01:09,296] TRACE [Controller id=0 epoch=2] Received response {error_code=0} for a request sent to broker kde:9092 (id: 0 rack: null) (state.change.logger)
[2018-03-09 10:01:09,296] TRACE [Broker id=0] Cached leader info PartitionState(controllerEpoch=2, leader=0, leaderEpoch=1, isr=[0], zkVersion=1, replicas=[1, 0], offlineReplicas=[1]) for partition EnrichTopic-0 in response to UpdateMetadata request sent by controller 0 epoch 2 with correlation id 8 (state.change.logger)
[2018-03-09 10:01:09,301] TRACE [Controller id=0 epoch=2] Received response {error_code=0} for a request sent to broker kde:9092 (id: 0 rack: null) (state.change.logger)
[2018-03-09 10:01:12,795] TRACE [Controller id=0 epoch=2] Started leader election for partition EnrichTopic-0 (state.change.logger)
[2018-03-09 10:01:12,796] ERROR [Controller id=0 epoch=2] Encountered error while electing leader for partition EnrichTopic-0 due to: No other replicas in ISR 0 for EnrichTopic-0 besides shutting down brokers 0 (state.change.logger)
[2018-03-09 10:01:12,797] ERROR [Controller id=0 epoch=2] Initiated state change for partition EnrichTopic-0 from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: [Controller id=0 epoch=2] Encountered error while electing leader for partition EnrichTopic-0 due to: No other replicas in ISR 0 for EnrichTopic-0 besides shutting down brokers 0
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:324)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:165)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:110)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:109)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:109)
	at kafka.controller.KafkaController$ControlledShutdown$$anonfun$kafka$controller$KafkaController$ControlledShutdown$$doControlledShutdown$4$$anonfun$apply$23.apply(KafkaController.scala:1489)
	at kafka.controller.KafkaController$ControlledShutdown$$anonfun$kafka$controller$KafkaController$ControlledShutdown$$doControlledShutdown$4$$anonfun$apply$23.apply(KafkaController.scala:1484)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$ControlledShutdown$$anonfun$kafka$controller$KafkaController$ControlledShutdown$$doControlledShutdown$4.apply(KafkaController.scala:1484)
	at kafka.controller.KafkaController$ControlledShutdown$$anonfun$kafka$controller$KafkaController$ControlledShutdown$$doControlledShutdown$4.apply(KafkaController.scala:1483)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.KafkaController$ControlledShutdown.kafka$controller$KafkaController$ControlledShutdown$$doControlledShutdown(KafkaController.scala:1483)
	at kafka.controller.KafkaController$ControlledShutdown$$anonfun$31.apply(KafkaController.scala:1461)
	at kafka.controller.KafkaController$ControlledShutdown$$anonfun$31.apply(KafkaController.scala:1461)
	at scala.util.Try$.apply(Try.scala:192)
	at kafka.controller.KafkaController$ControlledShutdown.process(KafkaController.scala:1461)
	at kafka.controller.ControllerEventManager$ControllerEventThread$$anonfun$doWork$1.apply$mcV$sp(ControllerEventManager.scala:53)
	at kafka.controller.ControllerEventManager$ControllerEventThread$$anonfun$doWork$1.apply(ControllerEventManager.scala:53)
	at kafka.controller.ControllerEventManager$ControllerEventThread$$anonfun$doWork$1.apply(ControllerEventManager.scala:53)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:52)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:64)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 0 for EnrichTopic-0 besides shutting down brokers 0
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:186)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:303)
	... 22 more
[2018-03-09 10:01:17,803] TRACE [Controller id=0 epoch=2] Started leader election for partition EnrichTopic-0 (state.change.logger)
[2018-03-09 10:01:17,803] ERROR [Controller id=0 epoch=2] Encountered error while electing leader for partition EnrichTopic-0 due to: No other replicas in ISR 0 for EnrichTopic-0 besides shutting down brokers 0 (state.change.logger)
[2018-03-09 10:01:17,803] ERROR [Controller id=0 epoch=2] Initiated state change for partition EnrichTopic-0 from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: [Controller id=0 epoch=2] Encountered error while electing leader for partition EnrichTopic-0 due to: No other replicas in ISR 0 for EnrichTopic-0 besides shutting down brokers 0
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:324)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:165)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:110)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:109)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:109)
	at kafka.controller.KafkaController$ControlledShutdown$$anonfun$kafka$controller$KafkaController$ControlledShutdown$$doControlledShutdown$4$$anonfun$apply$23.apply(KafkaController.scala:1489)
	at kafka.controller.KafkaController$ControlledShutdown$$anonfun$kafka$controller$KafkaController$ControlledShutdown$$doControlledShutdown$4$$anonfun$apply$23.apply(KafkaController.scala:1484)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$ControlledShutdown$$anonfun$kafka$controller$KafkaController$ControlledShutdown$$doControlledShutdown$4.apply(KafkaController.scala:1484)
	at kafka.controller.KafkaController$ControlledShutdown$$anonfun$kafka$controller$KafkaController$ControlledShutdown$$doControlledShutdown$4.apply(KafkaController.scala:1483)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.KafkaController$ControlledShutdown.kafka$controller$KafkaController$ControlledShutdown$$doControlledShutdown(KafkaController.scala:1483)
	at kafka.controller.KafkaController$ControlledShutdown$$anonfun$31.apply(KafkaController.scala:1461)
	at kafka.controller.KafkaController$ControlledShutdown$$anonfun$31.apply(KafkaController.scala:1461)
	at scala.util.Try$.apply(Try.scala:192)
	at kafka.controller.KafkaController$ControlledShutdown.process(KafkaController.scala:1461)
	at kafka.controller.ControllerEventManager$ControllerEventThread$$anonfun$doWork$1.apply$mcV$sp(ControllerEventManager.scala:53)
	at kafka.controller.ControllerEventManager$ControllerEventThread$$anonfun$doWork$1.apply(ControllerEventManager.scala:53)
	at kafka.controller.ControllerEventManager$ControllerEventThread$$anonfun$doWork$1.apply(ControllerEventManager.scala:53)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:52)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:64)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 0 for EnrichTopic-0 besides shutting down brokers 0
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:186)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:303)
	... 22 more
[2018-03-09 10:01:53,282] TRACE [Controller id=0 epoch=2] Started leader election for partition EnrichTopic-0 (state.change.logger)
[2018-03-09 10:01:53,283] ERROR [Controller id=0 epoch=2] Encountered error while electing leader for partition EnrichTopic-0 due to: No other replicas in ISR 0 for EnrichTopic-0 besides shutting down brokers 0 (state.change.logger)
[2018-03-09 10:01:53,283] ERROR [Controller id=0 epoch=2] Initiated state change for partition EnrichTopic-0 from OnlinePartition to OnlinePartition failed (state.change.logger)
kafka.common.StateChangeFailedException: [Controller id=0 epoch=2] Encountered error while electing leader for partition EnrichTopic-0 due to: No other replicas in ISR 0 for EnrichTopic-0 besides shutting down brokers 0
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:324)
	at kafka.controller.PartitionStateMachine.kafka$controller$PartitionStateMachine$$handleStateChange(PartitionStateMachine.scala:165)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:110)
	at kafka.controller.PartitionStateMachine$$anonfun$handleStateChanges$2.apply(PartitionStateMachine.scala:109)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.PartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:109)
	at kafka.controller.KafkaController$ControlledShutdown$$anonfun$kafka$controller$KafkaController$ControlledShutdown$$doControlledShutdown$4$$anonfun$apply$23.apply(KafkaController.scala:1489)
	at kafka.controller.KafkaController$ControlledShutdown$$anonfun$kafka$controller$KafkaController$ControlledShutdown$$doControlledShutdown$4$$anonfun$apply$23.apply(KafkaController.scala:1484)
	at scala.Option.foreach(Option.scala:257)
	at kafka.controller.KafkaController$ControlledShutdown$$anonfun$kafka$controller$KafkaController$ControlledShutdown$$doControlledShutdown$4.apply(KafkaController.scala:1484)
	at kafka.controller.KafkaController$ControlledShutdown$$anonfun$kafka$controller$KafkaController$ControlledShutdown$$doControlledShutdown$4.apply(KafkaController.scala:1483)
	at scala.collection.immutable.Set$Set1.foreach(Set.scala:94)
	at kafka.controller.KafkaController$ControlledShutdown.kafka$controller$KafkaController$ControlledShutdown$$doControlledShutdown(KafkaController.scala:1483)
	at kafka.controller.KafkaController$ControlledShutdown$$anonfun$31.apply(KafkaController.scala:1461)
	at kafka.controller.KafkaController$ControlledShutdown$$anonfun$31.apply(KafkaController.scala:1461)
	at scala.util.Try$.apply(Try.scala:192)
	at kafka.controller.KafkaController$ControlledShutdown.process(KafkaController.scala:1461)
	at kafka.controller.ControllerEventManager$ControllerEventThread$$anonfun$doWork$1.apply$mcV$sp(ControllerEventManager.scala:53)
	at kafka.controller.ControllerEventManager$ControllerEventThread$$anonfun$doWork$1.apply(ControllerEventManager.scala:53)
	at kafka.controller.ControllerEventManager$ControllerEventThread$$anonfun$doWork$1.apply(ControllerEventManager.scala:53)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:52)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:64)
Caused by: kafka.common.StateChangeFailedException: No other replicas in ISR 0 for EnrichTopic-0 besides shutting down brokers 0
	at kafka.controller.ControlledShutdownLeaderSelector.selectLeader(PartitionLeaderSelector.scala:186)
	at kafka.controller.PartitionStateMachine.electLeaderForPartition(PartitionStateMachine.scala:303)
	... 22 more
